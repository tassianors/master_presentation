%-------------------------------------------------------------------------------------------------
\section{Classes de Modelos}
%-------------------------------------------------------------------------------------------------
\subsection{Classes de modelos lineares} 
%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos}
\framesubtitle{Sistemas lineares - SISO de tempo discreto}

\begin{columns}
\column{0.6\textwidth}
	\begin{block}{Classe de modelos genérica}
	\begin{equation}
		A(z)y(t)=\frac{B(z)}{F(z)}u(t)+\frac{C(z)}{D(z)}e(t)
		\nonumber
	\end{equation}
	\end{block}
	onde:
	\begin{align*}
		A(z, \theta) &= 1+a_1z^{-1}+...+a_{na}z^{-n_a} \\ 
		B(z, \theta) &= b_1z^{-1}+...+b_{nb}z^{-n_b}\\ 
		C(z, \theta) &= 1+c_1z^{-1}+...+c_{nc}z^{-n_c}\\ 
		D(z, \theta) &= 1+d_1z^{-1}+...+d_{nd}z^{-n_d}\\ 
		F(z, \theta) &= 1+f_1z^{-1}+...+f_{nf}z^{-n_f}
	\end{align*}
	
\column{0.4\textwidth}
\begin{small}
\begin{table}
\begin{center}
\label{table:si_modeling_models}
\begin{tabular}{cl}
\hline
        Polinômios $\neq 1$ & Nome   \\
\hline
        B                 & FIR  	      \\ 
        AB                & ARX           \\ 
        ABC               & ARMAX         \\ 
        AC                & ARMA          \\ 
        ABD               & ARARX         \\ 
        ABCD              & ARARMAX       \\ 
        BF                & OE            \\ 
        BFCD              & Box-Jenkins   \\
\hline
\end{tabular}
\end{center}
\end{table}
\end{small}
\end{columns}
\end{frame}

%-------------------------------------------------------------------------------------------------
\subsection{Classes de modelos não lineares} 
%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos}
\framesubtitle{Sistemas não lineares}

\begin{itemize}
  \item Muitos são os tipos de classes de modelos para sistemas não lineares.
  \item Eles podem ser divididos em dois típos principais:
\begin{itemize}
  \item Não linearidades estáticas
  \item Não linearidades dinâmicas  
\end{itemize}
	\item Diversas classes de modelos se diferenciam pela escolha da base que irá representar o sistema.
\end{itemize}

\end{frame}

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos - Wiener e Hammerstein}
\framesubtitle{Sistemas não lineares}

\begin{columns}
\column{0.5\textwidth}
\begin{block}{Representa não linearidades estáticas}
\textcolor{blue}{Wiener}: Não linearidade acoplada na saída do sistema

\textcolor{blue}{Hammerstein}: Não linearidade acoplada na entrada do sistema
\end{block}

\column{0.5\textwidth}
\begin{figure}[htbp]
\center
\scalebox{0.6} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-1.6)(9.439062,1.6)
\usefont{T1}{ptm}{m}{n}
\rput(0.52453125,1.31){$u(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(3.9557812,1.31){$f(u(t))$}
\usefont{T1}{ptm}{m}{n}
\rput(7.554531,1.35){$y(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(5.8759375,1.15){Modelo}
\usefont{T1}{ptm}{m}{n}
\rput(5.7834377,0.75){Linear}
\usefont{T1}{ptm}{m}{n}
\rput(2.1957812,1.03){$f(\cdot)$}
\psframe[linewidth=0.04,dimen=outer](3.0,1.6)(1.2,0.4)
\psframe[linewidth=0.04,dimen=outer](6.8,1.6)(5.0,0.4)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.0,1.0)(5.0,1.0)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,1.0)(1.2,1.0)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.8,1.0)(8.0,1.0)
\usefont{T1}{ptm}{m}{n}
\rput(0.52453125,-0.69){$u(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(3.9357812,-0.69){$z(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(2.0759375,-0.85){Modelo}
\usefont{T1}{ptm}{m}{n}
\rput(1.9834375,-1.25){Linear}
\usefont{T1}{ptm}{m}{n}
\rput(5.9957814,-0.99){$f(\cdot)$}
\psframe[linewidth=0.04,dimen=outer](3.0,-0.4)(1.2,-1.6)
\psframe[linewidth=0.04,dimen=outer](6.8,-0.4)(5.0,-1.6)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.0,-1.0)(5.0,-1.0)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,-1.0)(1.2,-1.0)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.8,-1.0)(8.0,-1.0)
\usefont{T1}{ptm}{m}{n}
\rput(8.204532,-0.65){$y(t)=f(z(t))$}
\end{pspicture} 
}
\caption{Acima: modelo de Hammerstein. Abaixo: Modelo de Wiener.}
\label{fig:nl_models_hammerstein_wiener}
\end{figure}
\end{columns}

\end{frame}
%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos}
\framesubtitle{Sistemas não lineares}

\begin{itemize}
  \item Voltera: Relaciona valores passados da entrada com o valor atual da saída.
  	\begin{equation}
		y(t)=\sum_{j=1}^{\infty}\int_{-\infty}^{\infty}\cdots \int_{-\infty}^{\infty}
		h_j(\tau_1, ... ,\tau_j) \prod_{i=1}^{j}u(t-\tau_i)d\tau_i
	\nonumber
	\end{equation}
  \item Redes Neurais: 
  \begin{equation}
	x=f\left ( \sum_{j=1}^{n}\omega_j x_j +b \right )
	\label{eq:nl_models_neural}
  \end{equation}
  \begin{itemize}
    \item Redes neurais multi camadas
    \item Redes neurais recorrente
  \end{itemize}
  \item Funções radiais de base: Casos particulares de redes neurais, mas lineares nos parametros $\omega_i$.
  \begin{equation}
	f(y)=\omega_0+\sum_{i}\omega_i \phi (\left \| y-c_i \right \|)
	\label{eq:nl_models_rbf}
  \end{equation}	
\end{itemize}

\end{frame}
%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos - NARMAX}
\framesubtitle{Sistemas não lineares}

\begin{block} {Nonlinear AutoRegressive Moving Average model with eXogenous
variables}
\begin{equation}
y(t)=\theta^T\Phi_{nl}(y, u, e)
\label{eq:nlin_models_narmax_generic}
\end{equation}
onde $\Phi_{nl}(\cdot)$ denota um campo vetorial que depende dos valores passados de $y(t)$ e presente e passados de
$u(t)$ e $e(t)$; $\theta$ é o vetor de parâmetros a ser identificado.
\end{block}

\end{frame}

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos - NARMAX}
\framesubtitle{Modelo Polinômial}

\begin{block} {Modelo polinômial}
\begin{equation}
y(t)=\sum_{m=0}^{l}\sum_{p=0}^{m}\sum_{n1, n_m}^{n_y, n_u}c_{p,m-p}(n_1,...,n_m)\prod_{i=1}^{p}y(t-n_i)\prod_{i=p+1}^{m}u(t-n_i)
\end{equation}
sendo que

\begin{equation}
\sum_{n1,n_m}^{n_y,n_u}\equiv \sum_{n_1=1}^{n_y}\cdots\sum_{n_m=1}^{n_y}
\nonumber
\end{equation}
\end{block}

Exemplo:

\begin{equation}
y(t)=\alpha_1 u^2(t-1)+\alpha_2y(t-1)y^2(t-2)+\alpha_3u(t-2)y(t-1)
\nonumber
\end{equation}

\end{frame}

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Classes de modelos - NARMAX}
\framesubtitle{Modelo Racional}
\fontsize{7}{7}\selectfont

\begin{block} {Modelo Racional}

\begin{align}\nonumber
y(t) &=\frac{a(y(t-1), \ldots, y(t-n_y), u(t-1),\ldots, u(t-n_u), }{b(y(t-1), \ldots, y(t-n_y), u(t-1), \ldots, u(t-n_u),}\cdots \\ 
 & \cdots\frac{ e(t-1), \ldots, e(t-n_e))}{e(t-1), \ldots, e(t-n_e))} +e(t)
 \label{eq:nl_model_narmax_rat_simp}
\end{align}
\end{block}
\begin{equation}
a(t-1)=\sum_{j=1}^{N_n}p_{nj}\theta_{nj}=\psi _n^T(t-1)\theta_n
\nonumber
\end{equation}

\begin{equation}
b(t-1)=\sum_{j=1}^{N_d}p_{dj}\theta_{dj}=\psi _d^T(t-1)\theta_d
\nonumber
\end{equation}

Exemplo:

\begin{equation}
y(t)=\frac{\alpha_1 u^2(t-1)+\alpha_2y(t-1)y^2(t-2)+\alpha_3u(t-2)y(t-1)}{1+\alpha_4u^3(t-1)y(t-2)+\alpha_5y^3(t-1)}
\nonumber
\end{equation}

\end{frame}

%-------------------------------------------------------------------------------------------------
\subsection{Algoritmo de identificação de sistemas racionais} 
%-------------------------------------------------------------------------------------------------

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Algoritmo para identificação de modelos racionais}
\framesubtitle{Pode ser utilizado para modelos polinômiais}

\begin{block} {Modelo}
\begin{eqnarray}\label{eq:nl_alg_rational}
y(t)&=&\frac
{a(y(t-1), ..., y(t-n_y), u(t-1), ..., u(t-n_u))}
{b(y(t-1), ..., y(t-n_y), u(t-1), ..., u(t-n_u))}\\ \nonumber
&&  +c(e(t-1), ... , e(t-n_e)) +e(t)
\end{eqnarray}
\end{block}
\begin{itemize}
	\item O ruído é modelado por um polinômio que pode ou não ser linear.
	%\item Este algoritmo foi proposto por \cite{correa} e é uma modificação do algoritmo originalmente proposto por
%\cite{billings_zhu91}.
\end{itemize}

\end{frame}
%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Algoritmo para identificação de modelos racionais}
\fontsize{8}{8}\selectfont

\begin{block} {Passo 1}
Faça $i=0$. Monte a matriz $\Psi$ de regressão e estime os parâmetros usando
o método dos mínimos quadrados:

\begin{equation}
\begin{bmatrix}
\hat{\theta}_n^i\\ 
\hat{\theta}_{d1}^i
\end{bmatrix}=\left [ \Psi ^T \Psi \right ]^{-1}\Psi^T y^*
\label{nl_alg_rational_step_1}
\end{equation}
\end{block}

\begin{equation}
\Psi=\begin{bmatrix}
\psi_n^T(t-1) & \psi_{d1}^T(t-1)\\ 
\vdots & \vdots \\ 
\psi_n^T(t+N-2) & \psi_{d1}^T(t+N-2)
\end{bmatrix}
\nonumber
\end{equation}
\end{frame}

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Algoritmo para identificação de modelos racionais}
\fontsize{8}{8}\selectfont
\begin{block} {Passo 2}
Faça $i=i+1$. Determine os resíduos e sua variância, respectivamente como:

\begin{equation}
\xi ^i(t)=y(t)-\frac{\psi_n^T(t-1)\hat{\theta}_n}{\psi_{d}^T(t-1)\hat{\theta}_d}
\label{nl_alg_rational_step2_res}
\end{equation}

\begin{equation}
\left ( \sigma _{\xi}^2 \right )^i=\frac{1}{N-m_d}\sum_{i=m_d+1}^{N}\left ( \xi ^i(t) \right )^2
\label{eq:nl_alg_rational_step2_var}
\end{equation}
\end{block}

\begin{block} {Passo 3}
Usando-se os resíduos determinados no passo anterior, atualize $\Psi ^T \Psi$ e $\Psi^T y^*$
usando:

\begin{equation}
\Psi=\begin{bmatrix}
\psi_{n}^T(t-1) & y(t)\psi_{d1}^T(t-1)  & \psi_{\xi }^T(t-1) \\ 
\vdots & \vdots & \vdots\\ 
\psi_{n}^T(t+N-2) & y(t)\psi_{d1}^T(t+N-2)  & \psi_{\xi }^T(t+N-2)
\end{bmatrix}
\label{eq:nl_alg_rational_step3_psi}
\end{equation}
\end{block}
\end{frame}

%-------------------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Algoritmo para identificação de modelos racionais}
\framesubtitle{Passo 4 e 5}
\fontsize{8}{8}\selectfont

\textcolor{blue}{Passo 4}: Determine:
\begin{columns}
\fontsize{6}{6}\selectfont
\column{0.8\textwidth}
\begin{equation}
\Phi =\begin{bmatrix}
0      & \dots & 0      & 0 & \dots & 0 & \dots & 0 & \dots & 0\\ 
\vdots &       & \vdots & \vdots &  & \vdots &  & \vdots &  & \vdots\\ 
0      & \dots & 0      & \sum_{t=1}^{N}p_{d2}^2 & \dots & \sum_{t=1}^{N}p_{d2}p_{d_{N_d}}  & \dots & 0 & \dots & 0\\ 
\vdots &       & \vdots & \vdots &  & \vdots &  & \vdots &  & \vdots\\ 
0      & \dots & 0      & \sum_{t=1}^{N}p_{dN_d}p_{d2} & \dots & \sum_{t=1}^{N}p_{d_{N_d}}^2 & \dots & 0 & \dots & 0 
\end{bmatrix}
\nonumber
\end{equation}

\column{0.2\textwidth}
\begin{equation}
\phi =\begin{bmatrix}
0\\ 
\vdots\\ 
0\\ 
-\sum_{k=1}^{N} p_{d2}p_{d1}\\ 
\vdots\\ 
-\sum_{k=1}^{N} p_{dN_d}p_{d1}\\ 
0\\ 
\vdots\\
0
\end{bmatrix}
\nonumber
\end{equation}
\end{columns}
E estime novamente os parâmetros utilizando:

\begin{equation}
\begin{bmatrix}
\hat{\theta}_n^i\\ 
\hat{\theta}_{d1}^i
\end{bmatrix}=\left [ \Psi^T \Psi - (\sigma _{\xi}^2)^i \Phi  \right ]^{-1}
\left [ \Psi^T y^* - (\sigma _{\xi}^2)^i \phi \right ]
\label{eq:nl_alg_rational_step5}
\end{equation}

\textcolor{blue}{Passo 5}: Volte ao  \textcolor{blue}{Passo 2} até atingir convergência (de parâmetro ou de
variância de resíduo).
\end{frame}

