\documentclass[xcolor=dvipsnames,10pt]{beamer}
\mode<presentation>
{
	\usetheme{Warsaw}
}
\usepackage[latin1]{inputenc}
\usepackage[brazil]{babel}  
\usepackage{pstricks}
\usepackage{amssymb}

\begin{document}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\author{Tassiano Neuhaus}
\institute[]{PPGEE - UFRGS}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\subject{} \AtBeginSubsection[]
{
	\begin{frame}<beamer>
		\frametitle{Plan wyk³adu}
		\tableofcontents[currentsection,currentsubsection]
	\end{frame}
}

\title[PPGEE - UFRGS]{Projeto de controladores não lineares utilizando referência virtal}
\subtitle{Dissertação de mestrado}

\date{Maio de 2012}
\frame{\titlepage} 

\frame{\frametitle{Agenda}\tableofcontents} 

%Motivação
% - porque usar identificação de sistemas não lineares
%Introdução
% - Identificação de sistemas lineares
% - Modelos de sistemas não lineares
%VRFT
% - Referência virtual
%Modelos racionais
% - Algoritmo para identificação usando a referência virtual.
%Resultados obtidos
% - Exemplos
%Cronograma

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Objetivo e Motivação} 
%-------------------------------------------------------------------------------------------------

\frame{\frametitle{Objetivo / Motivação} 

\begin{block}{Objetivo}
	Objetivo é apresentar um estudo sobre identificação de controladores não lineares utilizando modelos 
	racionais e referência virtual.
\end{block}

\begin{block}{Motivação}
	\begin{itemize}
		\item Existem sistemas que não conseguem ser representados por sistemas lineares em toda
		sua faixa de operação.
		\item Normalmente sistemas não lineares possuem uma dinâmica mais rica, conseguindo representar
		com mais acuracidade alguns sistemas.
	\end{itemize}
\end{block}
}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Introdução} 
%-------------------------------------------------------------------------------------------------

\frame{\frametitle{Introdução}
Identificação de sistemas pode ser dividido em 3 partes principais:

	\begin{itemize}
		\item O sistema real a ser identificado $\mathcal{S}$
			\begin{equation}
				\mathcal{S}:\;\; y(t)=G_0(q)u(t)+H_0(q)e(t)
			\label{eq:si_intro_true_system}
			\end{equation}

		\item A classe de modelos a ser utilizada na identificação $\mathcal{M}$
			\begin{equation}
				\mathcal{M}: \;\;\left \{ G(q, \theta), H(q, \theta) | \theta \in D_{\mathcal{M}} \right \}
			\label{eq:si_intro_model}
			\end{equation}

		\item Algum critério para elencar qual modelo dentro da classe de modelos melhor
		consegue representar o sistema $\mathcal{S}$ nas propriedades escolhidas	
	\end{itemize}
}

\frame{\frametitle{Modelagem de sistemas não lineares}
  Existem diversas famílias de modelos para representar sistemas não lineares. Algumas delas são:

	\begin{itemize}
		\item Wiener e Hammerstein
		\item Série de Volterra
		\item Redes Neurais: multi camada e recorrentes
		\item Funções Radiais de Base
		\item Modelos NARMAX
	\end{itemize}

	\begin{block}{NARMAX}
	Nonlinear Autoregressive Moving Average Model with Exogenous Variables
	\begin{eqnarray}\nonumber
		y(t)&=&F [ y(t-1), ..., y(t-n_y), u(t-1), ... , u(t-n_u),\\
		&&  e(t),e(t-1), ... , e(t-n_e) ]
	\nonumber
	\end{eqnarray}
	\end{block}
}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Modelos Racionais NARMAX} 
%-------------------------------------------------------------------------------------------------
\frame{
	\frametitle{Classe de modelos racionais NARMAX}
		\linespread{1.3}
	
	Consiste na divisão de dois polinômios: 

\begin{eqnarray}\nonumber
y(t)&=&\frac
{a(y(t-1), ..., y(t-n_y), u(t-1), ..., u(t-n_u))}
{b(y(t-1), ..., y(t-n_y), u(t-1), ..., u(t-n_u))}\\
&&  +c(e(t-1), ... , e(t-n_e)) +e(t)
\label{eq:nl_alg_rational}
\end{eqnarray}

\begin{block}{Exemplo}
\begin{equation}
	y(t)=\frac{\theta_1y(t-1)+\theta_2y(t-1)u(t-1)+\theta_3u(t-1)}{1+\theta_4y^{2}(t-1)+\theta_5y^{2}(t-2)}
\label{eq:nl_rat_exemple2}
\end{equation}
\end{block}

}
%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Virtual Reference Feedback Tuning - VRFT} 
%-------------------------------------------------------------------------------------------------
\frame{
\frametitle{Referência Virtual para identificação de controladores}
\linespread{1.3}

\begin{block}{Ideia base}
	\begin{itemize}
	\item Escolher um modelo para representar o sistema em malha fechada $M(z)$
	\item Aplicar um sinal $u(t)$ sobre a planta, e com base na saída $y(t)$ e no
	modelo $M(z)$, obter os sinais virtuais $\bar{r}(t)$ e $e(t)$.
	\end{itemize}
\end{block}

\begin{figure}[htbp]
\center
\scalebox{0.8} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-1.4292188)(9.02,1.4692187)
\pscircle[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](1.4,0.97078127){0.2}
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](4.8,1.3707813)(3.0,0.57078123)
\psframe[linewidth=0.04,dimen=outer](7.6,1.3707813)(6.0,0.57078123)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,0.97078127)(1.2,0.97078127)
\psline[linewidth=0.04cm,linestyle=dashed,dash=0.16cm 0.16cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.6,0.97078127)(3.0,0.97078127)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(4.8,0.97078127)(6.0,0.97078127)
\psline[linewidth=0.04cm](7.6,0.97078127)(9.0,0.97078127)
\psline[linewidth=0.04cm,linestyle=dashed,dash=0.16cm 0.16cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{<-}(1.4,0.7707813)(1.4,-0.02921875)
\psline[linewidth=0.04cm,linestyle=dashed,dash=0.16cm 0.16cm](1.4,-0.02921875)(8.4,-0.02921875)
\psline[linewidth=0.04cm,linestyle=dashed,dash=0.16cm 0.16cm](8.4,-0.02921875)(8.4,0.97078127)
\usefont{T1}{ptm}{m}{n}
\rput(1.1126562,1.2807813){+}
\usefont{T1}{ptm}{m}{n}
\rput(1.6473438,0.68078125){-}
\usefont{T1}{ptm}{m}{n}
\rput(0.47,1.2707813){\small $\bar{r}(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(3.99,0.97078127){\small $C(z, \rho)$}
\usefont{T1}{ptm}{m}{n}
\rput(6.76,0.9507812){\small $G_0(z)$}
\usefont{T1}{ptm}{m}{n}
\rput(5.51,1.2707813){\small $u(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(2.25,1.2707813){\small $e(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(8.3,1.2707813){\small $y(t)$}
\psframe[linewidth=0.04,dimen=outer](6.0,-0.62921876)(3.8,-1.4292188)
\usefont{T1}{ptm}{m}{n}
\rput(4.91,-1.0492188){\small $M^{-1}(z)$}
\psline[linewidth=0.04cm](9.0,0.97078127)(9.0,-1.0292188)
\psline[linewidth=0.04cm](9.0,-1.0292188)(6.0,-1.0292188)
\psline[linewidth=0.04cm](3.8,-1.0292188)(0.0,-1.0292188)
\psline[linewidth=0.04cm](0.0,-1.0292188)(0.0,0.97078127)
\end{pspicture} 
}
\caption{Diagrama de blocos e sinais reais e virtuais envolvidos}
\label{fig:vrft_method_cl}
\end{figure}

}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Resultados obtidos} 
%-------------------------------------------------------------------------------------------------
\frame{\frametitle{Exemplo - Não linearidade estática: Modelo de Wiener}

\begin{block}{Não linearidade estática}
\begin{figure}[htbp]
\center
\scalebox{0.7} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-0.92)(11.62,0.9)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,0.3)(0.8,0.3)
\pscircle[linewidth=0.04,dimen=outer](1.0,0.3){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.2,0.3)(2.0,0.3)
\psframe[linewidth=0.04,dimen=outer](3.2,0.7)(2.0,-0.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.2,0.3)(4.2,0.3)
\psframe[linewidth=0.04,dimen=outer](5.4,0.7)(4.2,-0.1)
\psframe[linewidth=0.04,dimen=outer](8.0,0.7)(6.8,-0.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(8.0,0.3)(9.0,0.3)
\psframe[linewidth=0.04,dimen=outer](10.2,0.7)(9.0,-0.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(5.4,0.3)(6.8,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(10.2,0.3)(11.6,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{<-}(1.0,0.1)(1.0,-0.9)
\psline[linewidth=0.04cm](1.0,-0.9)(10.8,-0.9)
\psline[linewidth=0.04cm](10.8,-0.9)(10.8,0.3)
\usefont{T1}{ptm}{m}{n}
\rput(0.45828125,0.61){r(t)}
\usefont{T1}{ptm}{m}{n}
\rput(1.4946876,0.61){e(t)}
\usefont{T1}{ptm}{m}{n}
\rput(3.699375,0.61){v(t)}
\usefont{T1}{ptm}{m}{n}
\rput(6.089375,0.61){u(t)}
\usefont{T1}{ptm}{m}{n}
\rput(8.464531,0.61){$\omega(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(10.899375,0.61){y(t)}
\psline[linewidth=0.04cm](1.2,0.1)(1.4,0.1)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](5.6,0.9)(1.8,-0.3)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](10.4,0.9)(6.6,-0.3)
\usefont{T1}{ptm}{m}{n}
\rput(3.5345314,-0.59){C(z)}
\usefont{T1}{ptm}{m}{n}
\rput(8.544531,-0.59){G(z)}
\usefont{T1}{ptm}{m}{n}
\rput(2.6745312,0.41){$\Phi^{-1}$}
\usefont{T1}{ptm}{m}{n}
\rput(9.524531,0.41){$\Phi$}
\usefont{T1}{ptm}{m}{n}
\rput(4.7745314,0.41){C'(z)}
\usefont{T1}{ptm}{m}{n}
\rput(7.384531,0.41){G'(z)}
\end{pspicture} 
}
\caption{Diagrama de blocos para um sistema não linear do tipo Wiener}
\label{fig:vrft_nl_wiener}
\end{figure}
\end{block}
Sistema escolhido:

\begin{equation}
G'(z)=\frac{0.5}{z-0.9}
\label{eq:vrft_nl_wiener_g}
\end{equation} 

\begin{equation}
M(z)=\frac{0.4}{z-0.6}
\label{eq:vrft_nl_wiener_m}
\end{equation}  
}

\frame{\frametitle{Exemplo - Não linearidade estática: Modelo de Wiener}
A não linearidade presente na planta do sistema foi escolhida como sendo um polinômio de terceira ordem:

\begin{equation}
\Phi(\omega)=y(t)=1.5\omega(t)+0.2\omega^3(t)
\label{eq:vrft_nl_wiener_phi}
\end{equation}  

Espera-se então que por $M(z)$ ser linear, que o controlador tenha um bloco que seja o inverso de $\Phi$, para
que a não linearidade possa ser cancelada completamente.

\begin{equation}
\Phi^{-1}(e(t))= v(t) = a_1e(t) + a_2 e^2(t) +a_3 e^3(t) +a_4 e^4(t)
\label{eq:vrft_nl_wiener_phi_inv}
\end{equation}  

Desconsiderando a parte não linear presente na planta, é simples de observar que o controlador ótimo que
levaria a planta em malha fechada a ter o comportamento descrito por $M(z)$ é:

\begin{equation}
C_d(z)= \frac{0.8z-0.72}{z-1}
\label{eq:vrft_nl_wiener_cd}
\end{equation}

}

\frame{\frametitle{Exemplo - Não linearidade estática: Modelo de Wiener}
Foram feitos 100 experimentos de Monte Carlo e a média das estimativas obtidas foi de:

\begin{equation}
\text{média }\;\theta =\begin{bmatrix}
0.4471 \\ 0.0020 \\ -6.5105\times10^{-4} \\ -1.5959\times10^{-5} \\ -0.4043 \\ -0.0016 \\ 6.1194\times10^{-4}
\\ 1.4562\times10^{-5}
\end{bmatrix}^T
\nonumber
\end{equation}

O custo do sistema em malha fechada: somatório do quadrado da diferença entre o sinal esperado e o obtido 
foi de $J_{MR}(\theta)= 0.3820$
}

\frame{\frametitle{Exemplo - Não linearidade estática: Modelo de Wiener}
Sistema em malha fechada submetido a um sinal do tipo degrau unitário. 

%\begin{figure}[htbp] 
%	\center 
%	\includegraphics[width=0.85\columnwidth]{source/figures/vrft_nl_wiener_step.eps}
%	\caption{resposta dos sistemas: desejado e obtido a um degrau unitário}
%	\label{fig:vrft_nl_wiener_step}
%\end{figure}
}

\frame{\frametitle{Exemplo - Não linearidade estática: Modelo de Wiener}
Observa-se que a relação destes sinais é praticamente linear, garantido que a aproximação de $\Phi^{-1}$ foi
satisfatória para representar a inversa do sinal $\Phi$.


}


%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\frame{\frametitle{Exemplo: Não linearidades dinâmicas}
Sistema escolhido:

\begin{equation}
y(t)=\frac{0.1u(t-1)y(t-1)+u(t-1)}{1+0.25y^2(t-2)}
\label{eq:vrft_nl_dinamic_ex1_y}
\end{equation}

Deseja-se que em malha fechada seu comportamento seja como em:

\begin{equation}
M(z)=\frac{0.4}{z-0.6}
\label{eq:vrft_nl_dinamic_ex1_mz}
\end{equation}

O controlador ideal é descrito como:

\begin{equation}
u(t)=\frac{0.4r(t)+0.6y(t)+0.1y^2(t-2)r(t-1)+0.15y(t)y^2(t-1)}{1+0.5y(t)}
\label{eq:vrft_nl_dinamic_ex1_cd}
\end{equation}
}


\frame{\frametitle{Exemplo: Não linearidades dinâmicas}

\begin{block}{Classe de modelos escolhida}
\begin{equation}
	u(t)=\frac{\theta_1 r(t)+ \theta_2 y(t)+ \theta_3 y^2(t-2)r(t-1)+ \theta_4 y(t)y^2(t-1)}{1+ \theta_5 y(t)}
\label{eq:vrft_nl_dinamic_ex1_c}
\end{equation}
\end{block}

Resultados obtidos:

\begin{equation}
\text{média de }\theta=\begin{bmatrix}
0.4000 & 0.5999 & 0.1001 & 0.1501 & 0.5000
\end{bmatrix}
\nonumber
\end{equation}

\begin{equation}
\text{Desvio padrão de }\theta=1.0\times 10^{-3}\begin{bmatrix}
0.2231 & 0.6866 & 0.2411 & 0.6817 & 0.3019
\end{bmatrix}
\nonumber
\end{equation}
}

%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Cronograma} 
%-------------------------------------------------------------------------------------------------
\frame{
      \frametitle{Cronograma das próximas atividades}
            \linespread{1.3}

\begin{table}[htbp]
\begin{center}
\caption{Próximas atividades previstas para o ano de 2012 até a conclusão do trabalho:}
\label{table:si_modeling_models}
\begin{tabular}{ll}
        Previsão & Atividade  \\
\hline
\hline
        03 de Junho & Prova de proficiência em  língua estrangeira  \\ 
\hline
        Junho      & Finalização do artigo para congresso \\ 
\hline
		Junho a Agosto & Finalização da escrita da dissertação \\ 
\hline
		Setembro   & Defesa \\
\hline
\end{tabular}
\end{center}
\end{table}

} 
%-------------------------------------------------------------------------------------------------
%-------------------------------------------------------------------------------------------------
\section{Questões} 
%-------------------------------------------------------------------------------------------------

\frame{
      \frametitle{Questões}
            \linespread{1.3}
Muito Obrigado.
}
\end{document}
